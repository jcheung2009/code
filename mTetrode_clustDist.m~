function [distvect clustMtx] = mTetrode_clustDist(dataMtx,gmobj,clustIDs)
%
% [distvect clustMtx] = mMakeClustIDMtx(dataMtx,gmobj,clustIDs)
%
% calculates distance between elements in dataMtx and their closest cluster
% specified by clustIDs
% 
% gmobj is a gaussian mixture model object created by gmdistribution.fit 
%
% if dataMtx is N x M, clustIDs should be N x 1
%

datasize = size(dataMtx);
datasize = datasize(1);


clustMtx = zeros(size(dataMtx));
distmtx = zeros(datasize,length(clustIDs));

for clustnum=1:1:length(clustIDs) % each cluster
    clustcoords = gmobj.mu(clustnum,:);
    for i=1:1:datasize % compute distance cluster to each data point
        distmtx(i,clustnum) = pdist2(dataMtx(i,:),gmobj.mu(clustnum,:));
        
    end
    
%     theclust = clustIDs(i);
%     clustcoords = gmobj.mu(theclust,:);
%     clustMtx(i,:) = clustcoords;    
end

distmtx = pdist2(dataMtx,clustMtx);
distvect = diag(distmtx,0);