function downsample_batch(batch,CHANSPEC,newfs)
% cleandir4(batch,TH,wind,numwind,numnote,CHANSPEC)
% TH is the segment threshold
% wind is the window size in MS
% numwind is the number of notes in a window
% numnote is the numer of times numwind has to be observed in 1 file
%>> cleandir4('batch',1.0e-4,400,4,3);
%>> cleandir4('batch',1.0e-4,400,4,5);
% worked well on bk37w86 :
%>>OLD   ??? cleandir4('batch25',5.0e-5,500,6,10);
%cleandir4('batch',1e4,500,6,10,'obs0');


if (~exist('CHANSPEC'))
    CHANSPEC='w';
end

fid=fopen(batch,'r');
while (1)
    fn=fgetl(fid);
    if (~ischar(fn))
        break;
    end
    if (~exist(fn,'file'))
        continue;
    end
    %disp(fn);

    [pth,nm,ext]=fileparts(fn);
    if (strcmp(ext,'.ebin'))
        [dat,fs]=readevtaf(fn,'0r');
    else
        [dat,fs]=evsoundin('',fn,CHANSPEC);
    end
    newDat = resample();
    
end
fclose(fid);
return